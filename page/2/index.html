<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16-next.png">
  <link rel="mask-icon" href="/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;blog.cafeboy.org&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Pisces&quot;,&quot;version&quot;:&quot;8.5.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:false,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;}}</script><script src="/js/config.js"></script>
<meta name="description" content="Github 上的个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="后知后觉">
<meta property="og:url" content="https://blog.cafeboy.org/page/2/index.html">
<meta property="og:site_name" content="后知后觉">
<meta property="og:description" content="Github 上的个人博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Jumkey">
<meta property="article:tag" content="Blog, Cafeboy">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://blog.cafeboy.org/page/2/">



<script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:true,&quot;isPost&quot;:false,&quot;lang&quot;:&quot;zh-CN&quot;,&quot;comments&quot;:&quot;&quot;,&quot;permalink&quot;:&quot;&quot;,&quot;path&quot;:&quot;page&#x2F;2&#x2F;index.html&quot;,&quot;title&quot;:&quot;&quot;}</script>

<script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script>
<title>后知后觉</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">后知后觉</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Google Fans</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
        <li class="menu-item menu-item-goldcard"><a href="/goldcard/" rel="section"><i class="fa fa-credit-card fa-fw"></i>金卡</a></li>
        <li class="menu-item menu-item-bbpress-chinese-translation"><a href="/bbpress-chinese-translation/" rel="section"><i class="fa fa-globe fa-fw"></i>bbPress简体中文版</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jumkey"
      src="/uploads/avatar.jpg">
  <p class="site-author-name" itemprop="name">Jumkey</p>
  <div class="site-description" itemprop="description">Github 上的个人博客</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">66</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">82</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/jumkey" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jumkey" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/jumkey" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;jumkey" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/jumkey" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;jumkey" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.cafeboy.org/2011/11/28/redis-kv-design/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="Jumkey">
      <meta itemprop="description" content="Github 上的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="后知后觉">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2011/11/28/redis-kv-design/" class="post-title-link" itemprop="url">浅谈REDIS数据库的键值设计</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2011-11-28 13:26:48" itemprop="dateCreated datePublished" datetime="2011-11-28T13:26:48+08:00">2011-11-28</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2016-09-04 20:26:18" itemprop="dateModified" datetime="2016-09-04T20:26:18+08:00">2016-09-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%A5%E7%A7%AF%E6%9C%88%E7%B4%AF/" itemprop="url" rel="index"><span itemprop="name">日积月累</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2011/11/28/redis-kv-design/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2011/11/28/redis-kv-design/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>丰富的数据结构使得redis的设计非常的有趣。不像关系型数据库那样，DEV和DBA需要深度沟通，review每行sql语句，也不像memcached那样，不需要DBA的参与。redis的DBA需要熟悉数据结构，并能了解使用场景。</p>
<p>下面举一些常见适合kv数据库的例子来谈谈键值的设计，并与关系型数据库做一个对比，发现关系型的不足之处。</p>
<h2 id="用户登录系统"><a href="#用户登录系统" class="headerlink" title="用户登录系统"></a>用户登录系统</h2><p>记录用户登录信息的一个系统， 我们简化业务后只留下一张表。</p>
<h3 id="关系型数据库的设计"><a href="#关系型数据库的设计" class="headerlink" title="关系型数据库的设计"></a>关系型数据库的设计</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> login;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------------+-------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> user_id <span class="operator">|</span> name           <span class="operator">|</span> login_times <span class="operator">|</span> last_login_time     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------------+-------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">1</span> <span class="operator">|</span> ken thompson   <span class="operator">|</span>           <span class="number">5</span> <span class="operator">|</span> <span class="number">2011</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">2</span> <span class="operator">|</span> dennis ritchie <span class="operator">|</span>           <span class="number">1</span> <span class="operator">|</span> <span class="number">2011</span><span class="number">-02</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">3</span> <span class="operator">|</span> Joe Armstrong  <span class="operator">|</span>           <span class="number">2</span> <span class="operator">|</span> <span class="number">2011</span><span class="number">-03</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------------+-------------+---------------------+</span></span><br></pre></td></tr></table></figure>
<p>user_id表的主键，name表示用户名，login_times表示该用户的登录次数，每次用户登录后，login_times会自增，而last_login_time更新为当前时间。</p>
<h3 id="redis的设计"><a href="#redis的设计" class="headerlink" title="redis的设计"></a>redis的设计</h3><p>关系型数据转化为KV数据库，我的方法如下：</p>
<p>key 表名：主键值：列名</p>
<p>value 列值</p>
<p>一般使用冒号做分割符，这是不成文的规矩。比如在php-admin for redis系统里，就是默认以冒号分割，于是user:1 user:2等key会分成一组。于是以上的关系数据转化成kv数据后记录如下：</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set</span> login:<span class="number">1</span>:login_times <span class="number">5</span></span><br><span class="line"><span class="built_in">Set</span> login:<span class="number">2</span>:login_times <span class="number">1</span></span><br><span class="line"><span class="built_in">Set</span> login:<span class="number">3</span>:login_times <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Set</span> login:<span class="number">1</span>:last_login_time <span class="number">2011</span>-<span class="number">1</span>-<span class="number">1</span></span><br><span class="line"><span class="built_in">Set</span> login:<span class="number">2</span>:last_login_time <span class="number">2011</span>-<span class="number">2</span>-<span class="number">1</span></span><br><span class="line"><span class="built_in">Set</span> login:<span class="number">3</span>:last_login_time <span class="number">2011</span>-<span class="number">3</span>-<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> login:<span class="number">1</span>:name &quot;ken thompson&quot;</span><br><span class="line"><span class="built_in">set</span> login:<span class="number">2</span>:name &quot;dennis ritchie&quot;</span><br><span class="line"><span class="built_in">set</span> login:<span class="number">3</span>:name &quot;Joe Armstrong&quot;</span><br></pre></td></tr></table></figure>
<p>这样在已知主键的情况下，通过get、set就可以获得或者修改用户的登录次数和最后登录时间和姓名。</p>
<p>一般用户是无法知道自己的id的，只知道自己的用户名，所以还必须有一个从name到id的映射关系，这里的设计与上面的有所不同。</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> &quot;login:ken thompson:id&quot;      <span class="number">1</span></span><br><span class="line"><span class="built_in">set</span> &quot;login:dennis ritchie:id&quot;    <span class="number">2</span></span><br><span class="line"><span class="built_in">set</span> &quot;login:Joe Armstrong:id&quot;     <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>这样每次用户登录的时候业务逻辑如下（python版），r是redis对象，name是已经获知的用户名。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获得用户的id</span></span><br><span class="line">uid = r.get(<span class="string">&quot;login:%s:id&quot;</span> % name)</span><br><span class="line"><span class="comment">#自增用户的登录次数</span></span><br><span class="line">ret = r.incr(<span class="string">&quot;login:%s:login_times&quot;</span> % uid)</span><br><span class="line"><span class="comment">#更新该用户的最后登录时间</span></span><br><span class="line">ret = r.<span class="built_in">set</span>(<span class="string">&quot;login:%s:last_login_time&quot;</span> % uid, datetime.datetime.now())</span><br></pre></td></tr></table></figure>
<p>如果需求仅仅是已知id，更新或者获取某个用户的最后登录时间，登录次数，关系型和kv数据库无啥区别。一个通过btree pk，一个通过hash，效果都很好。</p>
<p>假设有如下需求，查找最近登录的N个用户。开发人员看看，还是比较简单的，一个sql搞定。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> login <span class="keyword">order</span> <span class="keyword">by</span> last_login_time <span class="keyword">desc</span> limit N</span><br></pre></td></tr></table></figure>
<p>DBA了解需求后，考虑到以后表如果比较大，所以在last_login_time上建个索引。执行计划从索引leafblock 的最右边开始访问N条记录，再回表N次，效果很好。</p>
<p>过了两天，又来一个需求，需要知道登录次数最多的人是谁。同样的关系型如何处理？DEV说简单</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> login <span class="keyword">order</span> <span class="keyword">by</span> login_times <span class="keyword">desc</span> limit N</span><br></pre></td></tr></table></figure>
<p>DBA一看，又要在login_time上建立一个索引。有没有觉得有点问题呢，表上每个字段上都有素引。</p>
<p>关系型数据库的数据存储的的不灵活是问题的源头，数据仅有一种储存方法，那就是按行排列的堆表。统一的数据结构意味着你必须使用索引来改变sql的访问路径来快速访问某个列的，而访问路径的增加又意味着你必须使用统计信息来辅助，于是一大堆的问题就出现了。</p>
<p>没有索引，没有统计计划，没有执行计划，这就是kv数据库。</p>
<p>redis里如何满足以上的需求呢？ 对于求最新的N条数据的需求，链表的后进后出的特点非常适合。我们在上面的登录代码之后添加一段代码，维护一个登录的链表，控制他的长度，使得里面永远保存的是最近的N个登录用户。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#把当前登录人添加到链表里</span></span><br><span class="line">ret = r.lpush(<span class="string">&quot;login:last_login_times&quot;</span>, uid)</span><br><span class="line"><span class="comment">#保持链表只有N位</span></span><br><span class="line">ret = redis.ltrim(<span class="string">&quot;login:last_login_times&quot;</span>, <span class="number">0</span>, N-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>这样需要获得最新登录人的id，如下的代码即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">last_login_list = r.lrange(<span class="string">&quot;login:last_login_times&quot;</span>, <span class="number">0</span>, N-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>另外，求登录次数最多的人，对于排序，积分榜这类需求，sorted set非常的适合，我们把用户和登录次数统一存储在一个sorted set里。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">zadd login:login_times <span class="number">5</span> <span class="number">1</span></span><br><span class="line">zadd login:login_times <span class="number">1</span> <span class="number">2</span></span><br><span class="line">zadd login:login_times <span class="number">2</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>这样假如某个用户登录，额外维护一个sorted set，代码如此</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#对该用户的登录次数自增1</span></span><br><span class="line">ret = r.zincrby(<span class="string">&quot;login:login_times&quot;</span>, <span class="number">1</span>, uid)</span><br></pre></td></tr></table></figure>
<p>那么如何获得登录次数最多的用户呢，逆序排列取的排名第N的用户即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ret = r.zrevrange(<span class="string">&quot;login:login_times&quot;</span>, <span class="number">0</span>, N-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>可以看出，DEV需要添加2行代码，而DBA不需要考虑索引什么的。</p>
<h2 id="TAG系统"><a href="#TAG系统" class="headerlink" title="TAG系统"></a>TAG系统</h2><p>tag在互联网应用里尤其多见，如果以传统的关系型数据库来设计有点不伦不类。我们以查找书的例子来看看redis在这方面的优势。</p>
<h3 id="关系型数据库的设计-1"><a href="#关系型数据库的设计-1" class="headerlink" title="关系型数据库的设计"></a>关系型数据库的设计</h3><p>两张表，一张book的明细，一张tag表，表示每本的tag，一本书存在多个tag。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> book;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+-------------------------------+----------------+</span></span><br><span class="line"><span class="operator">|</span> id   <span class="operator">|</span> name                          <span class="operator">|</span> author         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+-------------------------------+----------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> The Ruby Programming <span class="keyword">Language</span> <span class="operator">|</span> Mark Pilgrim   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Ruby <span class="keyword">on</span> rail                  <span class="operator">|</span> David Flanagan <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Programming Erlang            <span class="operator">|</span> Joe Armstrong  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+-------------------------------+----------------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tag;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+</span></span><br><span class="line"><span class="operator">|</span> tagname <span class="operator">|</span> book_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+</span></span><br><span class="line"><span class="operator">|</span> ruby    <span class="operator">|</span>       <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ruby    <span class="operator">|</span>       <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> web     <span class="operator">|</span>       <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> erlang  <span class="operator">|</span>       <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+</span></span><br></pre></td></tr></table></figure>
<p>假如有如此需求，查找即是ruby又是web方面的书籍，如果以关系型数据库会怎么处理？</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> b.name, b.author  <span class="keyword">from</span> tag t1, tag t2, book b</span><br><span class="line"><span class="keyword">where</span> t1.tagname <span class="operator">=</span> <span class="string">&#x27;web&#x27;</span> <span class="keyword">and</span> t2.tagname <span class="operator">=</span> <span class="string">&#x27;ruby&#x27;</span> <span class="keyword">and</span> t1.book_id <span class="operator">=</span> t2.book_id <span class="keyword">and</span> b.id <span class="operator">=</span> t1.book_id</span><br></pre></td></tr></table></figure>
<p>tag表自关联2次再与book关联，这个sql还是比较复杂的，如果要求即ruby，但不是web方面的书籍呢？</p>
<p>关系型数据其实并不太适合这些集合操作。</p>
<h3 id="redis的设计-1"><a href="#redis的设计-1" class="headerlink" title="redis的设计"></a>redis的设计</h3><p>首先book的数据肯定要存储的，和上面一样。</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> book:<span class="number">1</span>:name     &quot;The Ruby Programming Language&quot;</span><br><span class="line"><span class="built_in">Set</span> book:<span class="number">2</span>:name     &quot;Ruby on rail&quot;</span><br><span class="line"><span class="built_in">Set</span> book:<span class="number">3</span>:name     &quot;Programming Erlang&quot;</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> book:<span class="number">1</span>:author     &quot;Mark Pilgrim&quot;</span><br><span class="line"><span class="built_in">Set</span> book:<span class="number">2</span>:author     &quot;David Flanagan&quot;</span><br><span class="line"><span class="built_in">Set</span> book:<span class="number">3</span>:author     &quot;Joe Armstrong&quot;</span><br></pre></td></tr></table></figure>
<p>tag表我们使用集合来存储数据，因为集合擅长求交集、并集</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sadd tag:ruby <span class="number">1</span></span><br><span class="line">sadd tag:ruby <span class="number">2</span></span><br><span class="line">sadd tag:web <span class="number">2</span></span><br><span class="line">sadd tag:erlang <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>那么，即属于ruby又属于web的书？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inter_list = redis.sinter(<span class="string">&quot;tag.web&quot;</span>, <span class="string">&quot;tag:ruby&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>即属于ruby，但不属于web的书？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inter_list = redis.sdiff(<span class="string">&quot;tag.ruby&quot;</span>, <span class="string">&quot;tag:web&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>属于ruby和属于web的书的合集？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inter_list = redis.sunion(<span class="string">&quot;tag.ruby&quot;</span>, <span class="string">&quot;tag:web&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>简单到不行阿。</p>
<p>从以上2个例子可以看出在某些场景里，关系型数据库是不太适合的，你可能能够设计出满足需求的系统，但总是感觉的怪怪的，有种生搬硬套的感觉。</p>
<p>尤其登录系统这个例子，频繁的为业务建立索引。放在一个复杂的系统里，ddl（创建索引）有可能改变执行计划。导致其它的sql采用不同的执行计划，业务复杂的老系统，这个问题是很难预估的，sql千奇百怪。要求DBA对这个系统里所有的sql都了解，这点太难了。这个问题在oracle里尤其严重，每个DBA估计都碰到过。对于MySQL这类系统，ddl又不方便（虽然现在有online ddl的方法）。碰到大表，DBA凌晨爬起来在业务低峰期操作，这事我没少干过。而这种需求放到redis里就很好处理，DBA仅仅对容量进行预估即可。</p>
<p>未来的OLTP系统应该是kv和关系型的紧密结合。</p>
<p>转自：<a target="_blank" rel="noopener" href="http://www.hoterran.info/redis_kv_design">http://www.hoterran.info/redis_kv_design</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.cafeboy.org/2011/03/16/permissions-algorithm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="Jumkey">
      <meta itemprop="description" content="Github 上的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="后知后觉">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2011/03/16/permissions-algorithm/" class="post-title-link" itemprop="url">权限算法（按位与或）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2011-03-16 10:10:21" itemprop="dateCreated datePublished" datetime="2011-03-16T10:10:21+08:00">2011-03-16</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2016-09-04 17:42:27" itemprop="dateModified" datetime="2016-09-04T17:42:27+08:00">2016-09-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" itemprop="url" rel="index"><span itemprop="name">杂七杂八</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2011/03/16/permissions-algorithm/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2011/03/16/permissions-algorithm/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Create=1</p>
<p>Read=2</p>
<p>Update=4</p>
<p>Delete=8</p>
<p>YourPermissions=(Create|Delete)你的权限 这里是增加删除</p>
<p>判断增加权限 Create==(YourPermissions&amp;Create)</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.cafeboy.org/2011/03/11/poking-fun-at-programmers/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="Jumkey">
      <meta itemprop="description" content="Github 上的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="后知后觉">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2011/03/11/poking-fun-at-programmers/" class="post-title-link" itemprop="url">这个世界上只有程序猿是可以伤的……哈哈~</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2011-03-11 10:36:00" itemprop="dateCreated datePublished" datetime="2011-03-11T10:36:00+08:00">2011-03-11</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2016-09-04 18:57:01" itemprop="dateModified" datetime="2016-09-04T18:57:01+08:00">2016-09-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" itemprop="url" rel="index"><span itemprop="name">杂七杂八</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2011/03/11/poking-fun-at-programmers/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2011/03/11/poking-fun-at-programmers/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">尼玛程序员也有不是秃顶好不好！！！！！</span><br><span class="line">头发稀疏的也是有的好不好！！！</span><br><span class="line">我没有在小黑屋里工作！！！！！</span><br><span class="line">人家在明亮的办公室里工作！！！</span><br><span class="line">根本就没有一边扒薯片一边敲着键盘！！！！</span><br><span class="line"></span><br><span class="line">看看人家外国的程序员！！</span><br><span class="line">Spring的作者Rod Johnson拥有音乐学的博士学位的！！！！！！</span><br><span class="line">也是你们伤不起的那一型耶！！！！！！！！！！！</span><br><span class="line">怎么到了中国程序员都成猪了！！！！！！！！！！！</span><br><span class="line"></span><br><span class="line">什么？！</span><br><span class="line">你说Rod Johnson是秃顶？！</span><br><span class="line">我擦嘞！！！！！！！！！！</span><br><span class="line">你们学中文的没有秃顶啊！！！！！</span><br><span class="line">你们学法语的没有秃顶啊！！！！！</span><br><span class="line">你们学音乐的没有秃顶啊！！！！！</span><br><span class="line">你们学体育的没有秃顶啊！！！！！</span><br><span class="line">你们学金融的没有秃顶啊！！！！！</span><br><span class="line">你们学新闻的没有秃顶啊！！！！！</span><br><span class="line">学什么的没有秃顶啊！！！！！！！</span><br><span class="line">为什么你们就都伤不起！！！！！！</span><br><span class="line">就他妈程序员一定秃顶啊！！！！！</span><br><span class="line"></span><br><span class="line">为什么我咆哮的这么整齐！！！！！</span><br><span class="line">因为写程序要注意缩进的！！！！！</span><br><span class="line">很整齐有没有！！！！！！！！！！</span><br><span class="line">彬彬有礼有没有！！！！！！！！！</span><br><span class="line">逻辑关系很明了有没有！！！！！！</span><br><span class="line">不要再诽谤程序员秃顶了好不好！！</span><br><span class="line"></span><br><span class="line">&quot;那个人是做技术的，很冷血……&quot;</span><br><span class="line">冷你妹啊！！！！！！！！！！！！</span><br><span class="line">不能用天然呆形容啊！！！！！！！</span><br><span class="line">程序员又不是杀手！！！！！！！！</span><br><span class="line">这个程序员不太冷！！！！！！！！</span><br><span class="line">只是他妈的折翼了啊！！！！！！！</span><br><span class="line">折翼了啊！！！！！！！！！！！！</span><br><span class="line"></span><br><span class="line">学什么毕业了还要啃书的啊！！！！</span><br><span class="line">尼玛程序员的技术参考书每周都出新的啊！！！！</span><br><span class="line">卓越都买成VIP了啊！！！！！！！！！！</span><br><span class="line">地铁上啃书不是为了装逼啊！！！！！！</span><br><span class="line">400多页尼玛我乐意啊！！！！！！！！</span><br><span class="line">ant你大爷啊！！！！！！</span><br><span class="line">spring你大爷啊！！！！！</span><br><span class="line">ibatis你大爷啊！！！！！！</span><br><span class="line">hibernate你大爷啊！！！！！</span><br><span class="line"></span><br><span class="line">你丫豆瓣100颗小豆牛逼啥啊！！！！！</span><br><span class="line">一行代码啊！！！！！！！！！！！！！</span><br><span class="line">你丫开心农场100级牛逼啥啊！！！！！</span><br><span class="line">一行代码啊！！！！！！！！！！！！！</span><br><span class="line">你丫wow拿橙装牛逼啥啊！！！！！！！</span><br><span class="line">一行代码啊！！！！！！！！！！！！！</span><br><span class="line">你丫QQ到了太阳牛逼啥啊！！！！！！</span><br><span class="line">一行代码啊！！！！！！！！！！！！！</span><br><span class="line">服务器硬盘坏了不就都傻逼了！！！</span><br><span class="line">傻逼了啊！！！！！！！！！！！！</span><br><span class="line">我们程序员也帮不了了啊！！！！！</span><br><span class="line">程序员不会修硬盘啊！！！！！！！</span><br><span class="line">接网线什么的也不会啊！！！！！！</span><br><span class="line">我们不是网管啊！！！！！！！！！</span><br><span class="line">我们只会Thinking in java啊！！！！</span><br><span class="line">in java欧叶！！！！！！！！！！！</span><br><span class="line"></span><br><span class="line">计算机专业的修电脑的孩纸你们也伤不起啊！！！！！</span><br><span class="line">上辈子没事手贱折别人翅膀玩这辈子得报应啊！！！！</span><br><span class="line">上学的时候别系姑娘专门让你修电脑啊！！！！！！！</span><br><span class="line">自己还没摸几天电脑就要给人修电脑啊！！！！！！！</span><br><span class="line">连盲打都没学会问你为什么音箱没声音啊！！！！！！</span><br><span class="line">音箱没声音你不知道自己去后面看洞有没有插对啊！！</span><br><span class="line">绿插头插到红插孔里怎么会给你出声音啊！！！！！！</span><br><span class="line">买新硬盘设跳线也来问你啊！！！！</span><br><span class="line">自己不会看说明书啊！！！！！！！</span><br><span class="line">拿个磁盘拷进去一百多个mp3的快捷方式没法听也要说是计算机坏了啊！！！！！！</span><br><span class="line">计算机好冤枉的啊！！！！！！</span><br><span class="line"></span><br><span class="line">电脑可能出的问题至少八百多万种，有没有！！！！！！有没有！！！！！！</span><br><span class="line">每种故障至少二十种导致原因，有没有！！！！！！有没有！！！！！！</span><br><span class="line">课本教的东西跟这八百多万种问题一毛钱关系都没有啊！！！！！！</span><br><span class="line">每次都要自己上网搜索解决方法啊！！！！！！</span><br><span class="line">人家硬生生被逼成修电脑的好人啊！！！！！！</span><br><span class="line">中的木马跟病毒都够给杀毒软件公司当资料库了啊！！！！！！</span><br><span class="line"></span><br><span class="line">修电脑也罢了装电脑来问我价钱跟牌子算什么事啊！！！！！！</span><br><span class="line">我又不是电脑城给人装机的小弟把所有牌子的特点跟价格都背得一清二楚啊！！！！！！</span><br><span class="line"></span><br><span class="line">当年就不该选计算机专业啊！！！！！！</span><br><span class="line">现在每天坐在电脑前面一坐就是8个小时啊！！！！！！</span><br><span class="line">腰椎也突了啊！！！！！！</span><br><span class="line">颈椎也歪了啊！！！！！！</span><br><span class="line">腱鞘也畸形了啊！！！！！！</span><br><span class="line">胳膊肘也生老茧了啊！！！！！！</span><br><span class="line">脸也黄了啊！！！！！！</span><br><span class="line">斑也长了啊！！！！！！</span><br><span class="line">肥减不掉了啊！！！！！！</span><br><span class="line">黑眼圈褪不掉啊！！！！！</span><br><span class="line">这么苦逼的人森神马时候到尽头啊！！！！！！</span><br><span class="line"></span><br><span class="line">好吧～我只好转了～</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.cafeboy.org/2011/02/25/qqwry-to-ipwry/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="Jumkey">
      <meta itemprop="description" content="Github 上的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="后知后觉">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2011/02/25/qqwry-to-ipwry/" class="post-title-link" itemprop="url">纯真IP数据库(qqwry.dat)转换成最新的IP数据库格式(ipwry.dat)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2011-02-25 15:16:06" itemprop="dateCreated datePublished" datetime="2011-02-25T15:16:06+08:00">2011-02-25</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2018-11-12 22:56:29" itemprop="dateModified" datetime="2018-11-12T22:56:29+08:00">2018-11-12</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" itemprop="url" rel="index"><span itemprop="name">杂七杂八</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2011/02/25/qqwry-to-ipwry/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2011/02/25/qqwry-to-ipwry/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>ipwry.dat相比qqwry.dat占用空间更小，我们可以将纯真IP数据库(qqwry.dat)转换成最新的IP数据库格式(ipwry.dat)，两种格式都是<a target="_blank" rel="noopener" href="http://blog.csdn.net/cnss">CNSS</a>大神发明。</p>
<p>下面是具体的转换方法：</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ipwry <span class="number">0</span>.<span class="number">2</span>.<span class="number">2</span>c</span><br><span class="line">使用说明:</span><br><span class="line">-i [ --input ] arg (=qqwry.dat)  : 输入文件</span><br><span class="line">-o [ --output ] arg (=ipwry.dat) : 输出文件</span><br><span class="line">-l [ --lzma ]                    : 使用LZMA压缩数据</span><br><span class="line">-d [ --discard ] arg             : 要丢弃的地理地址</span><br><span class="line">-f [ --ipsearcher ]              : 生成与此程序版本相配的ipsearcher.dll</span><br><span class="line">-g [ --gbwry ]                   : 生成gbwry.dat文件</span><br><span class="line">-t [ --text ]                    : 生成文本文件</span><br><span class="line">-v [ --<span class="built_in">ver</span> ]                     : 显示版本</span><br><span class="line">-h [ --<span class="built_in">help</span> ]                    : 帮助</span><br></pre></td></tr></table></figure>
<p>制作方法:</p>
<p>1、将下面的代码保存为 *.bat 后缀的文件，如“IPwry.bat”</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">Echo</span> Off</span><br><span class="line"><span class="built_in">title</span> qqwry.dat转换为ipwry.dat</span><br><span class="line">IPwry -i QQwry.dat -o IPwry.dat -l</span><br><span class="line"><span class="built_in">Echo</span> IPwry.dat更新生成完毕</span><br><span class="line"><span class="built_in">pause</span></span><br><span class="line"><span class="keyword">Exit</span></span><br></pre></td></tr></table></figure>
<p>2、将“QQwry.dat”及“IPwry.exe”等放在同一文件夹下。</p>
<p>3、执行“IPwry.bat”便可以生成<a target="_blank" rel="noopener" href="http://blog.csdn.net/cnss">CNSS</a>格式的“IPwry.dat”IP文件了。</p>
<p>相关文件下载地址:</p>
<p>1、ipwry 0.2.2c</p>
<p>在下载页面选择“ipwry_0_2_2c.zip”这个</p>
<p><a target="_blank" rel="noopener" href="http://cosoft.org.cn/projects/ipwry/">http://cosoft.org.cn/projects/ipwry/</a></p>
<p>附带“IPwry.bat”的<a target="_blank" rel="noopener" href="https://blog-1252008710.cos-website.ap-shanghai.myqcloud.com/wp-content/uploads/2011/02/ipwry_0_2_2c.zip">ipwry_0_2_2c.zip</a>压缩包</p>
<p>2、纯真数据库</p>
<p><a target="_blank" rel="noopener" href="http://www.cz88.net/">http://www.cz88.net/</a></p>
<p>附带源码：<a target="_blank" rel="noopener" href="https://blog-1252008710.cos-website.ap-shanghai.myqcloud.com/wp-content/uploads/2013/09/IPwry0_2_2.zip">IPwry0_2_2</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.cafeboy.org/2010/12/13/java-treatment-websocket-protocol/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="Jumkey">
      <meta itemprop="description" content="Github 上的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="后知后觉">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2010/12/13/java-treatment-websocket-protocol/" class="post-title-link" itemprop="url">Java处理WebSocket协议</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2010-12-13 15:24:07" itemprop="dateCreated datePublished" datetime="2010-12-13T15:24:07+08:00">2010-12-13</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2016-09-04 18:34:32" itemprop="dateModified" datetime="2016-09-04T18:34:32+08:00">2016-09-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" itemprop="url" rel="index"><span itemprop="name">杂七杂八</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2010/12/13/java-treatment-websocket-protocol/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2010/12/13/java-treatment-websocket-protocol/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>处理类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Handshake</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span> crlf13 = (<span class="keyword">byte</span>) <span class="number">13</span>; <span class="comment">// &#x27;\r&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span> crlf10 = (<span class="keyword">byte</span>) <span class="number">10</span>; <span class="comment">// &#x27;\n&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> InputStream input;</span><br><span class="line"></span><br><span class="line">    Map http = <span class="keyword">new</span> HashMap();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> input</span></span><br><span class="line"><span class="comment">     *            输入流</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Handshake</span><span class="params">(InputStream input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.input = input;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] getResponse() <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        StringBuffer header = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        <span class="keyword">byte</span>[] content = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">8</span>];</span><br><span class="line">        <span class="keyword">byte</span>[] crlf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">int</span> crlfNum = <span class="number">0</span>; <span class="comment">// 已经连接的回车换行数 crlfNum=4为头部结束</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 读取头部</span></span><br><span class="line">        <span class="keyword">while</span> (input.read(crlf) != -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (crlf[<span class="number">0</span>] == crlf13 || crlf[<span class="number">0</span>] == crlf10) &#123;</span><br><span class="line">                crlfNum++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                crlfNum = <span class="number">0</span>;</span><br><span class="line">            &#125; <span class="comment">// 不是则清</span></span><br><span class="line">            header.append(<span class="keyword">new</span> String(crlf, <span class="number">0</span>, <span class="number">1</span>)); <span class="comment">// byte数组相+</span></span><br><span class="line">            <span class="keyword">if</span> (crlfNum == <span class="number">4</span>) &#123;</span><br><span class="line">                input.read(content); <span class="comment">// 读取内容</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String[] hhh = header.toString().split(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        http.put(<span class="string">&quot;Method&quot;</span>, hhh[<span class="number">0</span>].split(<span class="string">&quot; &quot;</span>)[<span class="number">0</span>]);</span><br><span class="line">        http.put(<span class="string">&quot;Path&quot;</span>, hhh[<span class="number">0</span>].split(<span class="string">&quot; &quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">        http.put(<span class="string">&quot;Http-Protocol&quot;</span>, hhh[<span class="number">0</span>].split(<span class="string">&quot; &quot;</span>)[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">        http.put(<span class="string">&quot;Upgrade&quot;</span>, header.substring(header.indexOf(<span class="string">&quot;Upgrade: &quot;</span>) + <span class="number">9</span>)</span><br><span class="line">                .split(<span class="string">&quot;\r\n&quot;</span>)[<span class="number">0</span>]);</span><br><span class="line">        http.put(<span class="string">&quot;Connection&quot;</span>, header.substring(</span><br><span class="line">                header.indexOf(<span class="string">&quot;Connection: &quot;</span>) + <span class="number">12</span>).split(<span class="string">&quot;\r\n&quot;</span>)[<span class="number">0</span>]);</span><br><span class="line">        http.put(<span class="string">&quot;Host&quot;</span>, header.substring(header.indexOf(<span class="string">&quot;Host: &quot;</span>) + <span class="number">6</span>).split(</span><br><span class="line">                <span class="string">&quot;\r\n&quot;</span>)[<span class="number">0</span>]);</span><br><span class="line">        http.put(<span class="string">&quot;Origin&quot;</span>, header.substring(header.indexOf(<span class="string">&quot;Origin: &quot;</span>) + <span class="number">8</span> )</span><br><span class="line">                .split(<span class="string">&quot;\r\n&quot;</span>)[<span class="number">0</span>]);</span><br><span class="line">        http.put(<span class="string">&quot;Sec-WebSocket-Key1&quot;</span>, header.substring(</span><br><span class="line">                header.indexOf(<span class="string">&quot;Sec-WebSocket-Key1: &quot;</span>) + <span class="number">20</span>).split(<span class="string">&quot;\r\n&quot;</span>)[<span class="number">0</span>]);</span><br><span class="line">        http.put(<span class="string">&quot;Sec-WebSocket-Key2&quot;</span>, header.substring(</span><br><span class="line">                header.indexOf(<span class="string">&quot;Sec-WebSocket-Key2: &quot;</span>) + <span class="number">20</span>).split(<span class="string">&quot;\r\n&quot;</span>)[<span class="number">0</span>]);</span><br><span class="line">        http.put(<span class="string">&quot;Content&quot;</span>, <span class="keyword">new</span> String(content));</span><br><span class="line"></span><br><span class="line">        String key1 = http.get(<span class="string">&quot;Sec-WebSocket-Key1&quot;</span>);</span><br><span class="line">        String key2 = http.get(<span class="string">&quot;Sec-WebSocket-Key2&quot;</span>);</span><br><span class="line">        <span class="comment">// 数字/空格数</span></span><br><span class="line">        <span class="keyword">long</span> a = Long.parseLong(filterNonNumeric(key1))</span><br><span class="line">                / filterNonSpace(key1).length();</span><br><span class="line">        <span class="keyword">long</span> b = Long.parseLong(filterNonNumeric(key2))</span><br><span class="line">                / filterNonSpace(key2).length();</span><br><span class="line">        <span class="comment">// 转换为十六进制字符串</span></span><br><span class="line">        String ekey1 = Long.toHexString(a).toUpperCase();</span><br><span class="line">        String ekey2 = Long.toHexString(b).toUpperCase();</span><br><span class="line">        String ekey3 = bytes2HexStr(content);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 补零</span></span><br><span class="line">        <span class="keyword">while</span> (ekey1.length() &lt; <span class="number">8</span> )</span><br><span class="line">            ekey1 = <span class="string">&quot;0&quot;</span> + ekey1;</span><br><span class="line">        <span class="keyword">while</span> (ekey2.length() &lt; <span class="number">8</span> )</span><br><span class="line">            ekey2 = <span class="string">&quot;0&quot;</span> + ekey2;</span><br><span class="line">        <span class="keyword">while</span> (ekey3.length() &lt; <span class="number">8</span> )</span><br><span class="line">            ekey3 = <span class="string">&quot;0&quot;</span> + ekey3;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[] bb = hexStr2Bytes(ekey1 + ekey2 + ekey3);</span><br><span class="line">        <span class="keyword">byte</span>[] challenge = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            challenge = MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>).digest(bb);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        sb.append(<span class="string">&quot;HTTP/1.1 101 WebSocket Protocol Handshake\r\n&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;Upgrade: WebSocket\r\n&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;Connection: Upgrade\r\n&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;Sec-WebSocket-Origin: &quot;</span> + http.get(<span class="string">&quot;Origin&quot;</span>) + <span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;Sec-WebSocket-Location: ws://&quot;</span> + http.get(<span class="string">&quot;Host&quot;</span>)</span><br><span class="line">                + http.get(<span class="string">&quot;Path&quot;</span>) + <span class="string">&quot;\r\n\r\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> addByte(sb.toString().getBytes(), challenge);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] getMsg() <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] bbbb = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] crlf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">while</span> (input.read(crlf) != -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="comment">// 处理任务</span></span><br><span class="line">            <span class="keyword">if</span> (crlf[<span class="number">0</span>] == (<span class="keyword">byte</span>) <span class="number">0</span>) &#123;</span><br><span class="line">                bbbb = <span class="keyword">new</span> <span class="keyword">byte</span>[] &#123;&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">            bbbb = addByte(bbbb, crlf);</span><br><span class="line">            <span class="keyword">if</span> (crlf[<span class="number">0</span>] == (<span class="keyword">byte</span>) <span class="number">255</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bbbb;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>工具类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Utils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 数组相+</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> target</span></span><br><span class="line"><span class="comment">     *            目标数组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> src</span></span><br><span class="line"><span class="comment">     *            加入数组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 相加后的结果</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] addByte(<span class="keyword">byte</span>[] target, <span class="keyword">byte</span>[] src) &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] a = <span class="keyword">new</span> <span class="keyword">byte</span>[target.length + src.length];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; target.length; i++) &#123;</span><br><span class="line">            a[i] = target[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = target.length; j &lt; a.length; j++) &#123;</span><br><span class="line">            a[j] = src[j - target.length];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 过滤掉非数字的字符</span></span><br><span class="line"><span class="comment">     * 例如：str=&quot;uis sdj13 e8 kj*ks90ao&quot;，则返回&quot;13890&quot;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> str</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 过滤后的字符串.如果str为空,则直接返回str</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">filterNonNumeric</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (str == <span class="keyword">null</span> || str == <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> str;</span><br><span class="line">        &#125;</span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">            <span class="keyword">char</span> c = str.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (Character.isDigit(c)) &#123;</span><br><span class="line">                sb.append(c);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 过滤掉非空格的字符</span></span><br><span class="line"><span class="comment">     * 例如：str=&quot;uis sdj13 e8 kj*ks90ao&quot;,则返回&quot;   &quot;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> str</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 过滤后的字符串.如果str为空,则直接返回str</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">filterNonSpace</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (str == <span class="keyword">null</span> || str == <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> str;</span><br><span class="line">        &#125;</span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">            <span class="keyword">char</span> c = str.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot; &quot;</span>.equals(String.valueOf(c))) &#123;</span><br><span class="line">                sb.append(c);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * byte[]转换成十六进制字符串</span></span><br><span class="line"><span class="comment">     * 例如：b=new byte[]&#123;0,(byte) 255&#125;,则返回&quot;00FF&quot;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> b</span></span><br><span class="line"><span class="comment">     *            byte数组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 大写十六进制字符串</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">bytes2HexStr</span><span class="params">(<span class="keyword">byte</span>[] b)</span> </span>&#123;</span><br><span class="line">        StringBuffer hs = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        String stmp = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">byte</span> n : b) &#123;</span><br><span class="line">            stmp = Integer.toHexString(n &amp; <span class="number">0XFF</span>);</span><br><span class="line">            hs.append((stmp.length() == <span class="number">1</span>) ? <span class="string">&quot;0&quot;</span> + stmp : stmp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> hs.toString().toUpperCase();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 十六进制字符串转换成byte[]</span></span><br><span class="line"><span class="comment">     * 例如：src=&quot;00FF&quot;,则返回new byte[]&#123;0,(byte) 255&#125;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> src</span></span><br><span class="line"><span class="comment">     *            大写十六进制字符串</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> byte数组</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] hexStr2Bytes(String src) &#123;</span><br><span class="line">        <span class="keyword">int</span> l = src.length() / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] ret = <span class="keyword">new</span> <span class="keyword">byte</span>[l];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; l; i++) &#123;</span><br><span class="line">            ret[i] = (<span class="keyword">byte</span>) Integer.parseInt(src.substring(i * <span class="number">2</span>, i * <span class="number">2</span> + <span class="number">2</span>),</span><br><span class="line">                    <span class="number">16</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>完成了协议分析的工作。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.cafeboy.org/2010/12/01/hibernate-multi-table-query-result-processing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="Jumkey">
      <meta itemprop="description" content="Github 上的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="后知后觉">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2010/12/01/hibernate-multi-table-query-result-processing/" class="post-title-link" itemprop="url">Hibernate多表查询结果处理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2010-12-01 02:22:41" itemprop="dateCreated datePublished" datetime="2010-12-01T02:22:41+08:00">2010-12-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2016-09-04 18:49:58" itemprop="dateModified" datetime="2016-09-04T18:49:58+08:00">2016-09-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" itemprop="url" rel="index"><span itemprop="name">杂七杂八</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2010/12/01/hibernate-multi-table-query-result-processing/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2010/12/01/hibernate-multi-table-query-result-processing/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>如果我们在Hibernate中需要查询多个表的不同字段，那么如何来获取Hibernate多表查询的结果呢？有两种方式：</p>
<p>1、 对各个字段分别转化成对应类型，如下：</p>
<p>Java代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Query q = session.createQuery(<span class="string">&quot; select members, classInfo.className &quot;</span></span><br><span class="line">		+ <span class="string">&quot; from Members members, ClassInfo classInfo &quot;</span></span><br><span class="line">		+ <span class="string">&quot; where members.level = classInfo.classCode &quot;</span>);</span><br><span class="line">List result = q.list();</span><br><span class="line">Iterator it = result.iterator();</span><br><span class="line"><span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">	Object[] tuple = (Object[]) it.next();</span><br><span class="line">	Members members = (Members) tuple[<span class="number">0</span>];</span><br><span class="line">	String className = (String) tuple[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是获取Hibernate多表查询的结果的最常用的方式。</p>
<p>2、构造自己的复合类型，如下：</p>
<p>Java代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Query q = session</span><br><span class="line">		.createQuery(<span class="string">&quot; select new NewMembers(members, classInfo.className) &quot;</span></span><br><span class="line">				+ <span class="string">&quot; from Members members, ClassInfo classInfo &quot;</span></span><br><span class="line">				+ <span class="string">&quot; where members.level = classInfo.classCode &quot;</span>);</span><br></pre></td></tr></table></figure>
<p>当然我们需要有一个NewMembers类和相应的构造方式。以上便是两种用于获取Hibernate多表查询的结果的方法以及其相应的代码。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.cafeboy.org/2010/11/25/come-back/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="Jumkey">
      <meta itemprop="description" content="Github 上的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="后知后觉">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2010/11/25/come-back/" class="post-title-link" itemprop="url">回来了</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2010-11-25 02:47:36" itemprop="dateCreated datePublished" datetime="2010-11-25T02:47:36+08:00">2010-11-25</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2016-09-04 17:42:27" itemprop="dateModified" datetime="2016-09-04T17:42:27+08:00">2016-09-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" itemprop="url" rel="index"><span itemprop="name">杂七杂八</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2010/11/25/come-back/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2010/11/25/come-back/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>我胡汉三又回来了！！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.cafeboy.org/2009/09/15/charming-french-beauty/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="Jumkey">
      <meta itemprop="description" content="Github 上的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="后知后觉">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2009/09/15/charming-french-beauty/" class="post-title-link" itemprop="url">迷人法国美女【记录】</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2009-09-15 17:53:52" itemprop="dateCreated datePublished" datetime="2009-09-15T17:53:52+08:00">2009-09-15</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2016-09-04 17:42:27" itemprop="dateModified" datetime="2016-09-04T17:42:27+08:00">2016-09-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" itemprop="url" rel="index"><span itemprop="name">杂七杂八</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2009/09/15/charming-french-beauty/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2009/09/15/charming-french-beauty/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><object width="480" height="334" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" align="middle"><param name="src" value="http://player.yinyuetai.com/video/player/2805/v_0.swf" /><param name="quality" value="high" /><param name="allowscriptaccess" value="sameDomain" /><embed width="480" height="334" type="application/x-shockwave-flash" src="http://player.yinyuetai.com/video/player/2805/v_0.swf" quality="high" allowscriptaccess="sameDomain" align="middle" /></object><br>La Isla Bonita - Alizee</p>
<p>艾莉婕Alizee小档案:<br>生日: 8月21日<br>年龄:1984生<br>星座: 狮子座<br>出生地: 法国南<br>兴趣: 绘画、舞蹈</p>
<p>出生于法国南部的海港-阿亚丘Ajaccio、柯西嘉岛上一个被地中海的阳光晒得刺眼却美得令人震慑的城市，1984年8月21日生日、狮子座的Alizee从小就在这里长大。也许是这儿的一切过于美好，她那过人的艺术天份与浑然天成的美，不自觉地就在她体内发酵、成熟、蕴生。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.cafeboy.org/2009/07/23/proud-to-see-the-solar-eclipse/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="Jumkey">
      <meta itemprop="description" content="Github 上的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="后知后觉">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2009/07/23/proud-to-see-the-solar-eclipse/" class="post-title-link" itemprop="url">经历日食全过程！</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2009-07-23 10:26:50" itemprop="dateCreated datePublished" datetime="2009-07-23T10:26:50+08:00">2009-07-23</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2016-09-04 17:42:27" itemprop="dateModified" datetime="2016-09-04T17:42:27+08:00">2016-09-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" itemprop="url" rel="index"><span itemprop="name">杂七杂八</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2009/07/23/proud-to-see-the-solar-eclipse/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2009/07/23/proud-to-see-the-solar-eclipse/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>几百年一遇的日全食，出现在中国。很幸运的我就在日全食可以看到的杭州。</p>
<p>记忆最深的是钻石戒指般的那个不知叫啥的</p>
<p>附上照片</p>
<p> <a target="_blank" rel="noopener" href="http://picasaweb.google.com/jumkey/tTwyrH">http://picasaweb.google.com/jumkey/tTwyrH</a></p>
<p>照片没有拍好。没有专业的工具。</p>
<p>实际景象绝对比照片震撼！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://blog.cafeboy.org/2009/06/27/100-rmb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="Jumkey">
      <meta itemprop="description" content="Github 上的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="后知后觉">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2009/06/27/100-rmb/" class="post-title-link" itemprop="url">100大洋</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2009-06-27 08:41:15" itemprop="dateCreated datePublished" datetime="2009-06-27T08:41:15+08:00">2009-06-27</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2016-09-04 23:48:08" itemprop="dateModified" datetime="2016-09-04T23:48:08+08:00">2016-09-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" itemprop="url" rel="index"><span itemprop="name">杂七杂八</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2009/06/27/100-rmb/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2009/06/27/100-rmb/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <table>
<thead>
<tr>
<th>成绩查询结果</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>准考证号:</td>
<td><strong>911533030032</strong></td>
<td>姓名:</td>
<td><strong>陈XX</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>出生年月:</td>
<td><strong>19880820</strong></td>
<td>性别:</td>
<td><strong>男</strong></td>
<td>报考级别:</td>
<td><strong>软件设计师</strong></td>
</tr>
<tr>
<td>上午成绩:</td>
<td><strong>49</strong></td>
<td>下午成绩:</td>
<td><strong>41</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>注：其中 -1为缺考，-2为作弊。</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2008 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jumkey</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  






  




<script class="next-config" data-name="disqus" type="application/json">{&quot;enable&quot;:true,&quot;shortname&quot;:&quot;jumkey&quot;,&quot;count&quot;:true,&quot;i18n&quot;:{&quot;disqus&quot;:&quot;disqus&quot;}}</script>
<script src="/js/third-party/comments/disqus.js"></script>

</body>
</html>
